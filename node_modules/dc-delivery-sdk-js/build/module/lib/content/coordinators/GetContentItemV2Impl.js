import { ContentItem } from '../model/ContentItem';
import { encodeQueryString } from '../../utils/Url';
import { HttpError } from '../model/HttpError';
import { ContentNotFoundError } from '../model/ContentNotFoundError';
/**
 * @hidden
 */
export class GetContentItemV2Impl {
    constructor(config, contentClient, mapper) {
        this.config = config;
        this.contentClient = contentClient;
        this.mapper = mapper;
    }
    getContentItemByKey(key) {
        return this.getContentItem('key', key);
    }
    async getContentItemById(id) {
        return this.getContentItem('id', id);
    }
    async getContentItem(requestType, value) {
        const args = [
            ['depth', 'all'],
            ['format', 'inlined'],
        ];
        if (this.config.locale) {
            args.push(['locale', this.config.locale]);
        }
        const url = `content/${requestType}/${value}?${encodeQueryString(args)}`;
        let response;
        try {
            response = await this.contentClient.get(url);
        }
        catch (err) {
            if (err.response) {
                if (err.response.status === 404) {
                    throw new ContentNotFoundError(value);
                }
                else {
                    throw new HttpError(err.response.status, err.response.data);
                }
            }
            throw err;
        }
        const contentItem = new ContentItem();
        contentItem.body = this.mapper.toMappedContent(response.data.content);
        return contentItem;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR2V0Q29udGVudEl0ZW1WMkltcGwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2NvbnRlbnQvY29vcmRpbmF0b3JzL0dldENvbnRlbnRJdGVtVjJJbXBsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUluRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNwRCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDL0MsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFHckU7O0dBRUc7QUFDSCxNQUFNLE9BQU8sb0JBQW9CO0lBRS9CLFlBQ21CLE1BQTZCLEVBQzdCLGFBQTRCLEVBQzVCLE1BQXFCO1FBRnJCLFdBQU0sR0FBTixNQUFNLENBQXVCO1FBQzdCLGtCQUFhLEdBQWIsYUFBYSxDQUFlO1FBQzVCLFdBQU0sR0FBTixNQUFNLENBQWU7SUFDckMsQ0FBQztJQUVKLG1CQUFtQixDQUNqQixHQUFXO1FBRVgsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBQ0QsS0FBSyxDQUFDLGtCQUFrQixDQUN0QixFQUFVO1FBRVYsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN2QyxDQUFDO0lBRUQsS0FBSyxDQUFDLGNBQWMsQ0FDbEIsV0FBeUIsRUFDekIsS0FBYTtRQUViLE1BQU0sSUFBSSxHQUFHO1lBQ1gsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDO1lBQ2hCLENBQUMsUUFBUSxFQUFFLFNBQVMsQ0FBQztTQUN0QixDQUFDO1FBQ0YsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRTtZQUN0QixJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztTQUMzQztRQUNELE1BQU0sR0FBRyxHQUFHLFdBQVcsV0FBVyxJQUFJLEtBQUssSUFBSSxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBRXpFLElBQUksUUFBdUIsQ0FBQztRQUM1QixJQUFJO1lBQ0YsUUFBUSxHQUFHLE1BQU0sSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDOUM7UUFBQyxPQUFPLEdBQUcsRUFBRTtZQUNaLElBQUksR0FBRyxDQUFDLFFBQVEsRUFBRTtnQkFDaEIsSUFBSSxHQUFHLENBQUMsUUFBUSxDQUFDLE1BQU0sS0FBSyxHQUFHLEVBQUU7b0JBQy9CLE1BQU0sSUFBSSxvQkFBb0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDdkM7cUJBQU07b0JBQ0wsTUFBTSxJQUFJLFNBQVMsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO2lCQUM3RDthQUNGO1lBRUQsTUFBTSxHQUFHLENBQUM7U0FDWDtRQUVELE1BQU0sV0FBVyxHQUFHLElBQUksV0FBVyxFQUFLLENBQUM7UUFDekMsV0FBVyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3RFLE9BQU8sV0FBVyxDQUFDO0lBQ3JCLENBQUM7Q0FDRiJ9