import axiosRetry from 'axios-retry';
import { createBaseContentClient } from './createBaseContentClient';
const isThrottled = (error) => error?.response?.status === 429;
const DEFAULT_RETRY_CONFIG = {
    retries: 3,
    retryDelay: axiosRetry.exponentialDelay,
    retryCondition: isThrottled,
};
/**
 * Get retry config to be passed to axios-retry
 * @param retryConfig
 * @hidden
 */
export function getRetryConfig(retryConfig) {
    return {
        retries: retryConfig?.retries ?? DEFAULT_RETRY_CONFIG.retries,
        retryDelay: retryConfig?.retryDelay ?? DEFAULT_RETRY_CONFIG.retryDelay,
        retryCondition: retryConfig?.retryCondition ?? DEFAULT_RETRY_CONFIG.retryCondition,
    };
}
/**
 * Create network client to make requests to the Fresh API service
 * @param config
 * @hidden
 */
export function createContentClientV2Fresh(config, defaultHost) {
    const client = createBaseContentClient(config, defaultHost);
    client.defaults.headers.common['X-API-Key'] = config.apiKey;
    axiosRetry(client, getRetryConfig(config.retryConfig));
    return client;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlQ29udGVudENsaWVudFYyRnJlc2guanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL2NsaWVudC9jcmVhdGVDb250ZW50Q2xpZW50VjJGcmVzaC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLFVBQVUsTUFBTSxhQUFhLENBQUM7QUFNckMsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFFcEUsTUFBTSxXQUFXLEdBQUcsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsTUFBTSxLQUFLLEdBQUcsQ0FBQztBQUMvRCxNQUFNLG9CQUFvQixHQUE2QjtJQUNyRCxPQUFPLEVBQUUsQ0FBQztJQUNWLFVBQVUsRUFBRSxVQUFVLENBQUMsZ0JBQWdCO0lBQ3ZDLGNBQWMsRUFBRSxXQUFXO0NBQzVCLENBQUM7QUFFRjs7OztHQUlHO0FBQ0gsTUFBTSxVQUFVLGNBQWMsQ0FDNUIsV0FBc0M7SUFFdEMsT0FBTztRQUNMLE9BQU8sRUFBRSxXQUFXLEVBQUUsT0FBTyxJQUFJLG9CQUFvQixDQUFDLE9BQU87UUFDN0QsVUFBVSxFQUFFLFdBQVcsRUFBRSxVQUFVLElBQUksb0JBQW9CLENBQUMsVUFBVTtRQUN0RSxjQUFjLEVBQ1osV0FBVyxFQUFFLGNBQWMsSUFBSSxvQkFBb0IsQ0FBQyxjQUFjO0tBQ3JFLENBQUM7QUFDSixDQUFDO0FBRUQ7Ozs7R0FJRztBQUNILE1BQU0sVUFBVSwwQkFBMEIsQ0FDeEMsTUFBa0MsRUFDbEMsV0FBbUI7SUFFbkIsTUFBTSxNQUFNLEdBQUcsdUJBQXVCLENBQUMsTUFBTSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBQzVELE1BQU0sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDO0lBQzVELFVBQVUsQ0FBQyxNQUFNLEVBQUUsY0FBYyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3ZELE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUMifQ==